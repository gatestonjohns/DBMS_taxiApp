const express = require('express');
const DBreader = require('./DBreader');
const oracledb = require('oracledb');
const ejs = require('ejs');
const url = require('url');
const fs = require('fs');

const app = express();
const port = 3000;
app.set('view engine', 'ejs');
app.use(express.static("public"));
var xMonthVals = ["Jan. 2018", "Feb.", "Mar.", "Apr.", "May", "June", "July", "Aug.", "Sept.", "Oct.", "Nov.", "Dec.",
    "Jan. 2019", "Feb.", "Mar.", "Apr.", "May", "June", "July", "Aug.", "Sept.", "Oct.", "Nov.", "Dec.",
    "Jan. 2020", "Feb.", "Mar.", "Apr.", "May", "June", "July", "Aug.", "Sept.", "Oct.", "Nov.", "Dec.",];
var xDayVals = [
    '1.1.2018', '2.1.2018', '3.1.2018', '4.1.2018', '5.1.2018',
    '6.1.2018', '7.1.2018', '8.1.2018', '9.1.2018', '10.1.2018',
    '11.1.2018', '12.1.2018', '13.1.2018', '14.1.2018', '15.1.2018',
    '16.1.2018', '17.1.2018', '18.1.2018', '19.1.2018', '20.1.2018',
    '21.1.2018', '22.1.2018', '23.1.2018', '24.1.2018', '25.1.2018',
    '26.1.2018', '27.1.2018', '28.1.2018', '29.1.2018', '30.1.2018',
    '31.1.2018', '1.2.2018', '2.2.2018', '3.2.2018', '4.2.2018',
    '5.2.2018', '6.2.2018', '7.2.2018', '8.2.2018', '9.2.2018',
    '10.2.2018', '11.2.2018', '12.2.2018', '13.2.2018', '14.2.2018',
    '15.2.2018', '16.2.2018', '17.2.2018', '18.2.2018', '19.2.2018',
    '20.2.2018', '21.2.2018', '22.2.2018', '23.2.2018', '24.2.2018',
    '25.2.2018', '26.2.2018', '27.2.2018', '28.2.2018', '1.3.2018',
    '2.3.2018', '3.3.2018', '4.3.2018', '5.3.2018', '6.3.2018',
    '7.3.2018', '8.3.2018', '9.3.2018', '10.3.2018', '11.3.2018',
    '12.3.2018', '13.3.2018', '14.3.2018', '15.3.2018', '16.3.2018',
    '17.3.2018', '18.3.2018', '19.3.2018', '20.3.2018', '21.3.2018',
    '22.3.2018', '23.3.2018', '24.3.2018', '25.3.2018', '26.3.2018',
    '27.3.2018', '28.3.2018', '29.3.2018', '30.3.2018', '31.3.2018',
    '1.4.2018', '2.4.2018', '3.4.2018', '4.4.2018', '5.4.2018',
    '6.4.2018', '7.4.2018', '8.4.2018', '9.4.2018', '10.4.2018',
    '11.4.2018', '12.4.2018', '13.4.2018', '14.4.2018', '15.4.2018',
    '16.4.2018', '17.4.2018', '18.4.2018', '19.4.2018', '20.4.2018',
    '21.4.2018', '22.4.2018', '23.4.2018', '24.4.2018', '25.4.2018',
    '26.4.2018', '27.4.2018', '28.4.2018', '29.4.2018', '30.4.2018',
    '1.5.2018', '2.5.2018', '3.5.2018', '4.5.2018', '5.5.2018',
    '6.5.2018', '7.5.2018', '8.5.2018', '9.5.2018', '10.5.2018',
    '11.5.2018', '12.5.2018', '13.5.2018', '14.5.2018', '15.5.2018',
    '16.5.2018', '17.5.2018', '18.5.2018', '19.5.2018', '20.5.2018',
    '21.5.2018', '22.5.2018', '23.5.2018', '24.5.2018', '25.5.2018',
    '26.5.2018', '27.5.2018', '28.5.2018', '29.5.2018', '30.5.2018',
    '31.5.2018', '1.6.2018', '2.6.2018', '3.6.2018', '4.6.2018',
    '5.6.2018', '6.6.2018', '7.6.2018', '8.6.2018', '9.6.2018',
    '10.6.2018', '11.6.2018', '12.6.2018', '13.6.2018', '14.6.2018',
    '15.6.2018', '16.6.2018', '17.6.2018', '18.6.2018', '19.6.2018',
    '20.6.2018', '21.6.2018', '22.6.2018', '23.6.2018', '24.6.2018',
    '25.6.2018', '26.6.2018', '27.6.2018', '28.6.2018', '29.6.2018',
    '30.6.2018', '1.7.2018', '2.7.2018', '3.7.2018', '4.7.2018',
    '5.7.2018', '6.7.2018', '7.7.2018', '8.7.2018', '9.7.2018',
    '10.7.2018', '11.7.2018', '12.7.2018', '13.7.2018', '14.7.2018',
    '15.7.2018', '16.7.2018', '17.7.2018', '18.7.2018', '19.7.2018',
    '20.7.2018', '21.7.2018', '22.7.2018', '23.7.2018', '24.7.2018',
    '25.7.2018', '26.7.2018', '27.7.2018', '28.7.2018', '29.7.2018',
    '30.7.2018', '31.7.2018', '1.8.2018', '2.8.2018', '3.8.2018',
    '4.8.2018', '5.8.2018', '6.8.2018', '7.8.2018', '8.8.2018',
    '9.8.2018', '10.8.2018', '11.8.2018', '12.8.2018', '13.8.2018',
    '14.8.2018', '15.8.2018', '16.8.2018', '17.8.2018', '18.8.2018',
    '19.8.2018', '20.8.2018', '21.8.2018', '22.8.2018', '23.8.2018',
    '24.8.2018', '25.8.2018', '26.8.2018', '27.8.2018', '28.8.2018',
    '29.8.2018', '30.8.2018', '31.8.2018', '1.9.2018', '2.9.2018',
    '3.9.2018', '4.9.2018', '5.9.2018', '6.9.2018', '7.9.2018',
    '8.9.2018', '9.9.2018', '10.9.2018', '11.9.2018', '12.9.2018',
    '13.9.2018', '14.9.2018', '15.9.2018', '16.9.2018', '17.9.2018',
    '18.9.2018', '19.9.2018', '20.9.2018', '21.9.2018', '22.9.2018',
    '23.9.2018', '24.9.2018', '25.9.2018', '26.9.2018', '27.9.2018',
    '28.9.2018', '29.9.2018', '30.9.2018', '1.10.2018', '2.10.2018',
    '3.10.2018', '4.10.2018', '5.10.2018', '6.10.2018', '7.10.2018',
    '8.10.2018', '9.10.2018', '10.10.2018', '11.10.2018', '12.10.2018',
    '13.10.2018', '14.10.2018', '15.10.2018', '16.10.2018', '17.10.2018',
    '18.10.2018', '19.10.2018', '20.10.2018', '21.10.2018', '22.10.2018',
    '23.10.2018', '24.10.2018', '25.10.2018', '26.10.2018', '27.10.2018',
    '28.10.2018', '29.10.2018', '30.10.2018', '31.10.2018', '1.11.2018',
    '2.11.2018', '3.11.2018', '4.11.2018', '5.11.2018', '6.11.2018',
    '7.11.2018', '8.11.2018', '9.11.2018', '10.11.2018', '11.11.2018',
    '12.11.2018', '13.11.2018', '14.11.2018', '15.11.2018', '16.11.2018',
    '17.11.2018', '18.11.2018', '19.11.2018', '20.11.2018', '21.11.2018',
    '22.11.2018', '23.11.2018', '24.11.2018', '25.11.2018', '26.11.2018',
    '27.11.2018', '28.11.2018', '29.11.2018', '30.11.2018', '1.12.2018',
    '2.12.2018', '3.12.2018', '4.12.2018', '5.12.2018', '6.12.2018',
    '7.12.2018', '8.12.2018', '9.12.2018', '10.12.2018', '11.12.2018',
    '12.12.2018', '13.12.2018', '14.12.2018', '15.12.2018', '16.12.2018',
    '17.12.2018', '18.12.2018', '19.12.2018', '20.12.2018', '21.12.2018',
    '22.12.2018', '23.12.2018', '24.12.2018', '25.12.2018', '26.12.2018',
    '27.12.2018', '28.12.2018', '29.12.2018', '30.12.2018', '31.12.2018',
    '1.1.2019', '2.1.2019', '3.1.2019', '4.1.2019', '5.1.2019',
    '6.1.2019', '7.1.2019', '8.1.2019', '9.1.2019', '10.1.2019',
    '11.1.2019', '12.1.2019', '13.1.2019', '14.1.2019', '15.1.2019',
    '16.1.2019', '17.1.2019', '18.1.2019', '19.1.2019', '20.1.2019',
    '21.1.2019', '22.1.2019', '23.1.2019', '24.1.2019', '25.1.2019',
    '26.1.2019', '27.1.2019', '28.1.2019', '29.1.2019', '30.1.2019',
    '31.1.2019', '1.2.2019', '2.2.2019', '3.2.2019', '4.2.2019',
    '5.2.2019', '6.2.2019', '7.2.2019', '8.2.2019', '9.2.2019',
    '10.2.2019', '11.2.2019', '12.2.2019', '13.2.2019', '14.2.2019',
    '15.2.2019', '16.2.2019', '17.2.2019', '18.2.2019', '19.2.2019',
    '20.2.2019', '21.2.2019', '22.2.2019', '23.2.2019', '24.2.2019',
    '25.2.2019', '26.2.2019', '27.2.2019', '28.2.2019', '1.3.2019',
    '2.3.2019', '3.3.2019', '4.3.2019', '5.3.2019', '6.3.2019',
    '7.3.2019', '8.3.2019', '9.3.2019', '10.3.2019', '11.3.2019',
    '12.3.2019', '13.3.2019', '14.3.2019', '15.3.2019', '16.3.2019',
    '17.3.2019', '18.3.2019', '19.3.2019', '20.3.2019', '21.3.2019',
    '22.3.2019', '23.3.2019', '24.3.2019', '25.3.2019', '26.3.2019',
    '27.3.2019', '28.3.2019', '29.3.2019', '30.3.2019', '31.3.2019',
    '1.4.2019', '2.4.2019', '3.4.2019', '4.4.2019', '5.4.2019',
    '6.4.2019', '7.4.2019', '8.4.2019', '9.4.2019', '10.4.2019',
    '11.4.2019', '12.4.2019', '13.4.2019', '14.4.2019', '15.4.2019',
    '16.4.2019', '17.4.2019', '18.4.2019', '19.4.2019', '20.4.2019',
    '21.4.2019', '22.4.2019', '23.4.2019', '24.4.2019', '25.4.2019',
    '26.4.2019', '27.4.2019', '28.4.2019', '29.4.2019', '30.4.2019',
    '1.5.2019', '2.5.2019', '3.5.2019', '4.5.2019', '5.5.2019',
    '6.5.2019', '7.5.2019', '8.5.2019', '9.5.2019', '10.5.2019',
    '11.5.2019', '12.5.2019', '13.5.2019', '14.5.2019', '15.5.2019',
    '16.5.2019', '17.5.2019', '18.5.2019', '19.5.2019', '20.5.2019',
    '21.5.2019', '22.5.2019', '23.5.2019', '24.5.2019', '25.5.2019',
    '26.5.2019', '27.5.2019', '28.5.2019', '29.5.2019', '30.5.2019',
    '31.5.2019', '1.6.2019', '2.6.2019', '3.6.2019', '4.6.2019',
    '5.6.2019', '6.6.2019', '7.6.2019', '8.6.2019', '9.6.2019',
    '10.6.2019', '11.6.2019', '12.6.2019', '13.6.2019', '14.6.2019',
    '15.6.2019', '16.6.2019', '17.6.2019', '18.6.2019', '19.6.2019',
    '20.6.2019', '21.6.2019', '22.6.2019', '23.6.2019', '24.6.2019',
    '25.6.2019', '26.6.2019', '27.6.2019', '28.6.2019', '29.6.2019',
    '30.6.2019', '1.7.2019', '2.7.2019', '3.7.2019', '4.7.2019',
    '5.7.2019', '6.7.2019', '7.7.2019', '8.7.2019', '9.7.2019',
    '10.7.2019', '11.7.2019', '12.7.2019', '13.7.2019', '14.7.2019',
    '15.7.2019', '16.7.2019', '17.7.2019', '18.7.2019', '19.7.2019',
    '20.7.2019', '21.7.2019', '22.7.2019', '23.7.2019', '24.7.2019',
    '25.7.2019', '26.7.2019', '27.7.2019', '28.7.2019', '29.7.2019',
    '30.7.2019', '31.7.2019', '1.8.2019', '2.8.2019', '3.8.2019',
    '4.8.2019', '5.8.2019', '6.8.2019', '7.8.2019', '8.8.2019',
    '9.8.2019', '10.8.2019', '11.8.2019', '12.8.2019', '13.8.2019',
    '14.8.2019', '15.8.2019', '16.8.2019', '17.8.2019', '18.8.2019',
    '19.8.2019', '20.8.2019', '21.8.2019', '22.8.2019', '23.8.2019',
    '24.8.2019', '25.8.2019', '26.8.2019', '27.8.2019', '28.8.2019',
    '29.8.2019', '30.8.2019', '31.8.2019', '1.9.2019', '2.9.2019',
    '3.9.2019', '4.9.2019', '5.9.2019', '6.9.2019', '7.9.2019',
    '8.9.2019', '9.9.2019', '10.9.2019', '11.9.2019', '12.9.2019',
    '13.9.2019', '14.9.2019', '15.9.2019', '16.9.2019', '17.9.2019',
    '18.9.2019', '19.9.2019', '20.9.2019', '21.9.2019', '22.9.2019',
    '23.9.2019', '24.9.2019', '25.9.2019', '26.9.2019', '27.9.2019',
    '28.9.2019', '29.9.2019', '30.9.2019', '1.10.2019', '2.10.2019',
    '3.10.2019', '4.10.2019', '5.10.2019', '6.10.2019', '7.10.2019',
    '8.10.2019', '9.10.2019', '10.10.2019', '11.10.2019', '12.10.2019',
    '13.10.2019', '14.10.2019', '15.10.2019', '16.10.2019', '17.10.2019',
    '18.10.2019', '19.10.2019', '20.10.2019', '21.10.2019', '22.10.2019',
    '23.10.2019', '24.10.2019', '25.10.2019', '26.10.2019', '27.10.2019',
    '28.10.2019', '29.10.2019', '30.10.2019', '31.10.2019', '1.11.2019',
    '2.11.2019', '3.11.2019', '4.11.2019', '5.11.2019', '6.11.2019',
    '7.11.2019', '8.11.2019', '9.11.2019', '10.11.2019', '11.11.2019',
    '12.11.2019', '13.11.2019', '14.11.2019', '15.11.2019', '16.11.2019',
    '17.11.2019', '18.11.2019', '19.11.2019', '20.11.2019', '21.11.2019',
    '22.11.2019', '23.11.2019', '24.11.2019', '25.11.2019', '26.11.2019',
    '27.11.2019', '28.11.2019', '29.11.2019', '30.11.2019', '1.12.2019',
    '2.12.2019', '3.12.2019', '4.12.2019', '5.12.2019', '6.12.2019',
    '7.12.2019', '8.12.2019', '9.12.2019', '10.12.2019', '11.12.2019',
    '12.12.2019', '13.12.2019', '14.12.2019', '15.12.2019', '16.12.2019',
    '17.12.2019', '18.12.2019', '19.12.2019', '20.12.2019', '21.12.2019',
    '22.12.2019', '23.12.2019', '24.12.2019', '25.12.2019', '26.12.2019',
    '27.12.2019', '28.12.2019', '29.12.2019', '30.12.2019', '31.12.2019',
    '1.1.2020', '2.1.2020', '3.1.2020', '4.1.2020', '5.1.2020',
    '6.1.2020', '7.1.2020', '8.1.2020', '9.1.2020', '10.1.2020',
    '11.1.2020', '12.1.2020', '13.1.2020', '14.1.2020', '15.1.2020',
    '16.1.2020', '17.1.2020', '18.1.2020', '19.1.2020', '20.1.2020',
    '21.1.2020', '22.1.2020', '23.1.2020', '24.1.2020', '25.1.2020',
    '26.1.2020', '27.1.2020', '28.1.2020', '29.1.2020', '30.1.2020',
    '31.1.2020', '1.2.2020', '2.2.2020', '3.2.2020', '4.2.2020',
    '5.2.2020', '6.2.2020', '7.2.2020', '8.2.2020', '9.2.2020',
    '10.2.2020', '11.2.2020', '12.2.2020', '13.2.2020', '14.2.2020',
    '15.2.2020', '16.2.2020', '17.2.2020', '18.2.2020', '19.2.2020',
    '20.2.2020', '21.2.2020', '22.2.2020', '23.2.2020', '24.2.2020',
    '25.2.2020', '26.2.2020', '27.2.2020', '28.2.2020', '29.2.2020',
    '1.3.2020', '2.3.2020', '3.3.2020', '4.3.2020', '5.3.2020',
    '6.3.2020', '7.3.2020', '8.3.2020', '9.3.2020', '10.3.2020',
    '11.3.2020', '12.3.2020', '13.3.2020', '14.3.2020', '15.3.2020',
    '16.3.2020', '17.3.2020', '18.3.2020', '19.3.2020', '20.3.2020',
    '21.3.2020', '22.3.2020', '23.3.2020', '24.3.2020', '25.3.2020',
    '26.3.2020', '27.3.2020', '28.3.2020', '29.3.2020', '30.3.2020',
    '31.3.2020', '1.4.2020', '2.4.2020', '3.4.2020', '4.4.2020',
    '5.4.2020', '6.4.2020', '7.4.2020', '8.4.2020', '9.4.2020',
    '10.4.2020', '11.4.2020', '12.4.2020', '13.4.2020', '14.4.2020',
    '15.4.2020', '16.4.2020', '17.4.2020', '18.4.2020', '19.4.2020',
    '20.4.2020', '21.4.2020', '22.4.2020', '23.4.2020', '24.4.2020',
    '25.4.2020', '26.4.2020', '27.4.2020', '28.4.2020', '29.4.2020',
    '30.4.2020', '1.5.2020', '2.5.2020', '3.5.2020', '4.5.2020',
    '5.5.2020', '6.5.2020', '7.5.2020', '8.5.2020', '9.5.2020',
    '10.5.2020', '11.5.2020', '12.5.2020', '13.5.2020', '14.5.2020',
    '15.5.2020', '16.5.2020', '17.5.2020', '18.5.2020', '19.5.2020',
    '20.5.2020', '21.5.2020', '22.5.2020', '23.5.2020', '24.5.2020',
    '25.5.2020', '26.5.2020', '27.5.2020', '28.5.2020', '29.5.2020',
    '30.5.2020', '31.5.2020', '1.6.2020', '2.6.2020', '3.6.2020',
    '4.6.2020', '5.6.2020', '6.6.2020', '7.6.2020', '8.6.2020',
    '9.6.2020', '10.6.2020', '11.6.2020', '12.6.2020', '13.6.2020',
    '14.6.2020', '15.6.2020', '16.6.2020', '17.6.2020', '18.6.2020',
    '19.6.2020', '20.6.2020', '21.6.2020', '22.6.2020', '23.6.2020',
    '24.6.2020', '25.6.2020', '26.6.2020', '27.6.2020', '28.6.2020',
    '29.6.2020', '30.6.2020', '1.7.2020', '2.7.2020', '3.7.2020',
    '4.7.2020', '5.7.2020', '6.7.2020', '7.7.2020', '8.7.2020',
    '9.7.2020', '10.7.2020', '11.7.2020', '12.7.2020', '13.7.2020',
    '14.7.2020', '15.7.2020', '16.7.2020', '17.7.2020', '18.7.2020',
    '19.7.2020', '20.7.2020', '21.7.2020', '22.7.2020', '23.7.2020',
    '24.7.2020', '25.7.2020', '26.7.2020', '27.7.2020', '28.7.2020',
    '29.7.2020', '30.7.2020', '31.7.2020', '1.8.2020', '2.8.2020',
    '3.8.2020', '4.8.2020', '5.8.2020', '6.8.2020', '7.8.2020',
    '8.8.2020', '9.8.2020', '10.8.2020', '11.8.2020', '12.8.2020',
    '13.8.2020', '14.8.2020', '15.8.2020', '16.8.2020', '17.8.2020',
    '18.8.2020', '19.8.2020', '20.8.2020', '21.8.2020', '22.8.2020',
    '23.8.2020', '24.8.2020', '25.8.2020', '26.8.2020', '27.8.2020',
    '28.8.2020', '29.8.2020', '30.8.2020', '31.8.2020', '1.9.2020',
    '2.9.2020', '3.9.2020', '4.9.2020', '5.9.2020', '6.9.2020',
    '7.9.2020', '8.9.2020', '9.9.2020', '10.9.2020', '11.9.2020',
    '12.9.2020', '13.9.2020', '14.9.2020', '15.9.2020', '16.9.2020',
    '17.9.2020', '18.9.2020', '19.9.2020', '20.9.2020', '21.9.2020',
    '22.9.2020', '23.9.2020', '24.9.2020', '25.9.2020', '26.9.2020',
    '27.9.2020', '28.9.2020', '29.9.2020', '30.9.2020', '1.10.2020',
    '2.10.2020', '3.10.2020', '4.10.2020', '5.10.2020', '6.10.2020',
    '7.10.2020', '8.10.2020', '9.10.2020', '10.10.2020', '11.10.2020',
    '12.10.2020', '13.10.2020', '14.10.2020', '15.10.2020', '16.10.2020',
    '17.10.2020', '18.10.2020', '19.10.2020', '20.10.2020', '21.10.2020',
    '22.10.2020', '23.10.2020', '24.10.2020', '25.10.2020', '26.10.2020',
    '27.10.2020', '28.10.2020', '29.10.2020', '30.10.2020', '31.10.2020',
    '1.11.2020', '2.11.2020', '3.11.2020', '4.11.2020', '5.11.2020',
    '6.11.2020', '7.11.2020', '8.11.2020', '9.11.2020', '10.11.2020',
    '11.11.2020', '12.11.2020', '13.11.2020', '14.11.2020', '15.11.2020',
    '16.11.2020', '17.11.2020', '18.11.2020', '19.11.2020', '20.11.2020',
    '21.11.2020', '22.11.2020', '23.11.2020', '24.11.2020', '25.11.2020',
    '26.11.2020', '27.11.2020', '28.11.2020', '29.11.2020', '30.11.2020',
    '1.12.2020', '2.12.2020', '3.12.2020', '4.12.2020', '5.12.2020',
    '6.12.2020', '7.12.2020', '8.12.2020', '9.12.2020', '10.12.2020',
    '11.12.2020', '12.12.2020', '13.12.2020', '14.12.2020', '15.12.2020',
    '16.12.2020', '17.12.2020', '18.12.2020', '19.12.2020', '20.12.2020',
    '21.12.2020', '22.12.2020', '23.12.2020', '24.12.2020', '25.12.2020',
    '26.12.2020', '27.12.2020', '28.12.2020', '29.12.2020', '30.12.2020',
    '31.12.2020'
];


// CODE TO CREATE CONNECTION TO DATABASE [PROMISE]
let connection = oracledb.getConnection({
    user: 'GATESTON.JOHNS',
    password: '4aAyj8i9VQTerfetnglbCydx',
    connectString: 'oracle.cise.ufl.edu/orcl'
});

connection.then((connection) => {
    console.log("Connection established, I think...");
})
.catch(() => { console.log("Error in getting query results...") });


// CODE FOR HOME PAGE HANDLING
app.get('/', (req, res) => {
    res.sendFile("index.html", { root: __dirname });
})


// CODE FOR ABOUT PAGE HANDLING
app.get('/about', (req, res) => {
    res.sendFile('about.html', { root: __dirname });
});


// CODE FOR DRIVERS PAGE HANDLING
app.get('/taxiDrivers', (req, res) => {
    if (!(Object.keys(req.query).length === 0)) {
        console.log(req.query);
        var qry = req.query.query;
        var tDom = req.query.timeDomain;
        var xAxis = xMonthVals;
        if (tDom === 'day') {
            xAxis = xDayVals;
        }

        connection.then((connection) => {
            var qRes;

            switch (qry) {
                case "optimalTimeToDrive":
                    qRes = DBreader.optimalTimeToDrive(connection, tDom);
                    break;
                case "tipsPerMile":
                    qRes = DBreader.tipsPerMile(connection, tDom);
                    break;
                default:
                    console.log("Switch case error!");
            }

            qRes.then((qRes) => {
                console.log(qRes);

                var yVals = [], rows = qRes['rows'];
                for (let i = 0, len = rows.length; i < len; i++) {
                    yVals.push(rows[i][0]);
                }


                res.render("pages/driverStarterPage", {
                    xAxis: xAxis,
                    yVals: yVals,
                    title: qry
                })
            }).catch(() => { console.log("Error in getting query results...") });
        }).catch(() => { console.log("Error in establishing DB connection...") });
    }
    else {
        res.sendFile('driverStarterPage.html', { root: __dirname });
    }
});


// CODE FOR BUSINESS OWNERS PAGE HANDLING
app.get("/businessOwners", (req, res) => {
    if (!(Object.keys(req.query).length === 0)) {
        console.log(req.query);
        var qry = req.query.query;
        var tDom = req.query.timeDomain;
        var xAxis = xMonthVals;
        if (tDom === 'day') {
            xAxis = xDayVals;
        }

        connection.then((connection) => {
            var qRes;

            switch (qry) {
                case "tripTimeLength":
                    qRes = DBreader.tripTimeLength(connection, tDom);
                    break;
                case "overallCostWithInflation":
                    qRes = DBreader.overallCostWithInflation(connection, tDom);
                    break;
                case "taxiTravelSpeed":
                    qRes = DBreader.taxiTravelSpeed(connection, tDom);
                    break;
                default:
                    console.log("Switch case error!");
            }

            qRes.then((qRes) => {
                console.log(qRes);

                var yVals = [], rows = qRes['rows'];
                for (let i = 0, len = rows.length; i < len; i++) {
                    yVals.push(rows[i][0]);
                }


                res.render("pages/businessStarterPage", {
                    xAxis: xAxis,
                    yVals: yVals,
                    title: qry
                })
            }).catch(() => { console.log("Error in getting query results...") });
        }).catch(() => { console.log("Error in establishing DB connection...") });
    }
    else {
        res.sendFile('businessStarterPage.html', { root: __dirname });
    }
});


// CODE FOR RIDERS PAGE REQUEST
app.get('/riders', (req, res) => {
    if (!(Object.keys(req.query).length === 0)) {
        console.log(req.query);
        var qry = req.query.query;
        var tDom = req.query.timeDomain;
        var gt = req.query.groupThreshold;
        var xAxis = xMonthVals;
        if (tDom === 'day') {
            xAxis = xDayVals;
        }

        connection.then((connection) => {
            var qRes;

            switch (qry) {
                case "loneRidersPercentage":
                    qRes = DBreader.loneRidersPercentage(connection, tDom);
                    break;
                case "percentGroupRides":
                    qRes = DBreader.percentGroupRides(connection, tDom, gt);
                    break;
                default:
                    console.log("Switch case error!");
            }


            qRes.then((qRes) => {
                console.log(qRes);

                var yVals = [], rows = qRes['rows'];
                for (let i = 0, len = rows.length; i < len; i++) {
                    yVals.push(rows[i][0]);
                }


                res.render("pages/riderStarterPage", {
                    xAxis: xAxis,
                    yVals: yVals,
                    title: qry
                })
            }).catch(() => { console.log("Error in getting query results...") });
        }).catch(() => { console.log("Error in establishing DB connection...") });
    }
    else {
        res.sendFile('riderStarterPage.html', { root: __dirname });
    }
});


// START LISTENING/SERVING
app.listen(port, () => {
    console.log(`Example app listening on port ${port}`)
})